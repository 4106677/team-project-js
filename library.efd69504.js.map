{"mappings":"gfAEAA,EAAA,S,0DCSAC,EAXuB,CACrBC,OAAQ,0CACRC,WAAY,kCACZC,YACE,yEACFC,UAAW,kBACXC,cAAe,8BACfC,kBAAmB,aACnBC,MAAO,2C,mDDMJC,aAAaC,QAAQ,WAAWC,eAIjCF,aAAaC,QAAQ,cACLE,SAASC,cAAc,WAC/BC,iBAAiB,SAAS,WAClCL,aAAaM,WAAW,aACxBN,aAAaM,WAAW,OACxBN,aAAaM,WAAW,WACxBN,aAAaM,WAAW,SACxBH,SAASI,SAASC,Q,IAI6CD,SAAxDE,KAAO,eAGlBC,EAAAC,iBAAiBC,uBAEjB,IAAMC,EAAiBV,SAASC,cAAc,wBACxCU,EAAkBX,SAASC,cAAc,YACzCW,EAAgBZ,SAASC,cAAc,UAE7CU,EAAgBT,iBAAiB,UAuBjC,WACEW,EAAiBC,EAAQ,U,IAvB3BF,EAAcV,iBAAiB,UA2B/B,WACEW,EAAiBC,EAAQ,Q,IAzBL,IAAlBA,EAASjB,aAAaC,QAAQ,OA6BlC,SAASe,EAAiBE,EAAKC,GAC7B,IAAMC,GAAM,EAAAC,EAAAC,eAAc9B,GACpB+B,GAAW,EAAAC,EAAAC,aAAYL,GAEvBM,GAAkB,EAAAF,EAAAG,QAAM,EAAAH,EAAAI,KAAIL,EAAU,SAAWL,EAAM,IAAMC,KAEnE,EAAAK,EAAAK,SAAQH,GAAiB,SAAAI,GACvB,IACE,IAAMC,EAAOC,OAAOC,OAAOH,EAASI,OACpCrB,EAAesB,WAAY,EAAAC,EAAAC,SAAgBN,E,CAC3C,MAAAO,GAEEzB,EAAesB,UADF,YAAXhB,EACyB,kCAEA,+B,KAvC/BnB,aAAaC,QAAQ,SACvB,EAAAsC,EAAAC,uBAAsBvB,GAGpBA,EACFD,EAAiBC,EAAQ,WAEzBJ,EAAesB,UAAY,yCAKG,EAAhCM,EAAAJ,U","sources":["src/library.js","src/js/apps/fireBaseConfig.js"],"sourcesContent":["// import watchedFilms from './js/watchedFilms';\n// import queueFilms from './js/queueFilms';\nimport { getId } from './js/trailer';\nimport { setDataToLocalStorage } from './js/apps/dataBaseApi';\nimport { openLoginModal } from './js/modal-of-login';\nimport { teamModalService } from './js/team-modal-service';\nimport { initializeApp } from 'firebase/app';\nimport firebaseConfig from './js/apps/fireBaseConfig';\nimport { getDatabase, ref, set, query, onValue } from 'firebase/database';\nimport oneMovieCardTmp from './templates/oneMovieCard.hbs';\nimport modalDetailMovie from './js/modal-detail-movie';\nimport './js/theme';\n\n// получаю все жанры и сохраняю в localstorage(\"genres\")\nif (!localStorage.getItem('genres')) getAllgenres();\n\n// функция LogOut\n//\nif (localStorage.getItem('userEmail')) {\n  const logOutRef = document.querySelector('#logout');\n  logOutRef.addEventListener('click', () => {\n    localStorage.removeItem('userEmail');\n    localStorage.removeItem('uid');\n    localStorage.removeItem('watched');\n    localStorage.removeItem('queue');\n    document.location.reload();\n  });\n} else {\n  // Если пользователь не авторизирован его преребрасывает на главную страницу\n  location.href = './index.html';\n}\n\nteamModalService.eventListenerCreator();\n\nconst listSectionRef = document.querySelector('.movies-popular-list');\nconst inputWatchedRef = document.querySelector('#watched');\nconst inputQueueRef = document.querySelector('#queue');\n\ninputWatchedRef.addEventListener('change', onWatchedInput);\ninputQueueRef.addEventListener('change', onQueueInput);\n\n// ============ первая загрузка страницы =================================\nlet userid = localStorage.getItem('uid');\n\n// загрузка очередей фильмов в LocalStorage из DB\n\nif (localStorage.getItem('uid')) {\n  setDataToLocalStorage(userid);\n}\n\nif (userid) {\n  readFromDataBase(userid, 'watched');\n} else {\n  listSectionRef.innerHTML = '<p> В списке пока еще нет фильмов</p>';\n}\n// =========================================================================\n\n// Модалка с подробный описанием  фильма\nmodalDetailMovie();\n\n// Press Watched button\nfunction onWatchedInput() {\n  readFromDataBase(userid, 'watched');\n}\n\n// Press Queue button\nfunction onQueueInput() {\n  readFromDataBase(userid, 'queue');\n}\n\n// Функция чтение из базы данных\nfunction readFromDataBase(uid, target) {\n  const app = initializeApp(firebaseConfig);\n  const database = getDatabase(app);\n\n  const topUserPostsRef = query(ref(database, 'films/' + uid + '/' + target));\n\n  onValue(topUserPostsRef, snapshot => {\n    try {\n      const data = Object.values(snapshot.val());\n      listSectionRef.innerHTML = oneMovieCardTmp(data);\n    } catch {\n      if (target === 'watched') {\n        listSectionRef.innerHTML = '<p>Watched library is empty</p>';\n      } else {\n        listSectionRef.innerHTML = '<p>Queue library is empty</p>';\n      }\n    }\n  });\n}\n","const firebaseConfig = {\n  apiKey: 'AIzaSyD8Xe_Nj5r_CTsQ1IiUWTLdW_hWsbx85Eg',\n  authDomain: 'filmoteka-6051d.firebaseapp.com',\n  databaseURL:\n    'https://filmoteka-6051d-default-rtdb.europe-west1.firebasedatabase.app',\n  projectId: 'filmoteka-6051d',\n  storageBucket: 'filmoteka-6051d.appspot.com',\n  messagingSenderId: '7192088333',\n  appId: '1:7192088333:web:7a18c384db98030289ea44',\n};\n\nexport default firebaseConfig;\n"],"names":["parcelRequire","$c992ebec05b07dd5$export$2e2bcd8739ae039","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","localStorage","getItem","getAllgenres","document","querySelector","addEventListener","removeItem","location","reload","href","$a9oGP","teamModalService","eventListenerCreator","$cecbdd76f2d3d4bd$var$listSectionRef","$cecbdd76f2d3d4bd$var$inputWatchedRef","$cecbdd76f2d3d4bd$var$inputQueueRef","$cecbdd76f2d3d4bd$var$readFromDataBase","$cecbdd76f2d3d4bd$var$userid","uid","target","app","$6Urw1","initializeApp","database","$6Nu6u","getDatabase","topUserPostsRef","query","ref","onValue","snapshot","data","Object","values","val","innerHTML","$gRtPP","default","e","$6HAUt","setDataToLocalStorage","$cALHK"],"version":3,"file":"library.efd69504.js.map"}